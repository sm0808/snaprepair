{"version":3,"sources":["../../src/pages/modal-final-fare/modal-final-fare.module.ts","../../src/pages/modal-final-fare/modal-final-fare.ts"],"names":[],"mappings":"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","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ModalFinalFarePage } from './modal-final-fare';\n\n@NgModule({\n  declarations: [\n    ModalFinalFarePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ModalFinalFarePage),\n  ],\n})\nexport class ModalFinalFarePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modal-final-fare/modal-final-fare.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, AlertController, LoadingController, NavParams, ViewController } from 'ionic-angular';\nimport { LocalNotifications } from '@ionic-native/local-notifications';\nimport { UserProvider } from '../../providers/user/user';\nimport { TripService } from \"../../services/trip-service\";\n\n/**\n * Generated class for the ModalFinalFarePage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-modal-final-fare',\n  templateUrl: 'modal-final-fare.html',\n})\nexport class ModalFinalFarePage {\n  carddata: any;\n  responsedata: any={};\n\n   total_amount:any;\n   trip_key:any;\n  constructor( public tripService: TripService,public navCtrl: NavController, \n               public userService: UserProvider, public navParams: NavParams, \n               public alertCtrl: AlertController, public loadingCtrl: LoadingController, \n               public viewCtrl: ViewController, public localNotifications: LocalNotifications) {\n    this.carddata = this.navParams.get('Card');\n    //alert(JSON.stringify(this.carddata))\n\n    this.total_amount= this.navParams.get('data')\n    this.trip_key=this.navParams.get('key');\n\n    console.log(\"Fare AMounts++++++++\", this.total_amount);    \n    console.log(\"Trip key++++++++\", this.trip_key);\n  }\n  data: any = {};\n  ionViewCanEnter() {\n    this.data = this.navParams.get('data');\n  }\n  // dismiss() {\n  //   this.viewCtrl.dismiss();\n  // }\n  dismiss() {\n    let loading = this.loadingCtrl.create({ content: 'Processing...' });\n    loading.present();\n    let xmlhttp = new XMLHttpRequest();\n    xmlhttp.open('POST', 'https://dbstage1.paywire.com/API/pwapi.aspx');\n\n    let sr =\n      `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n        <PAYMENTREQUEST>\n           <TRANSACTIONHEADER>\n              <PWVERSION>3</PWVERSION>\n            <PWUSER>yurt1</PWUSER>\n               <PWPASS>Kt93SbYZ</PWPASS>\n               <PWCLIENTID>0000010062</PWCLIENTID>\n               <PWKEY>8A0B6FA9-D918-4D84-B02F-5BB7C8578F4D</PWKEY>\n              <PWTRANSACTIONTYPE>SALE</PWTRANSACTIONTYPE>\n              <PWSALEAMOUNT>`+ this.data['total'] + `</PWSALEAMOUNT>\n              <CARDPRESENT>FALSE</CARDPRESENT>\n           </TRANSACTIONHEADER>\n           <CUSTOMER>\n              <PWMEDIA>CC</PWMEDIA>\n               <PWTOKEN>`+ this.carddata['pwtoken'] + `</PWTOKEN>\n           </CUSTOMER>\n        </PAYMENTREQUEST>`;\n\n    xmlhttp.onreadystatechange = () => {\n      if (xmlhttp.readyState == 4) {\n        if (xmlhttp.status == 200) {\n\n\n          let xml = xmlhttp.responseXML;\n          var response = xml.getElementsByTagName(\"PAYMENTRESPONSE\")[0];\n\n          let length = response.childElementCount;\n\n          // console.log(\"Length \", length);\n          // console.log(\"Response Data\", response);\n\n          if (length < 9) {\n            \n            let rideinfo ;\n            this.tripService.getrideinfo(this.trip_key).subscribe(snapshot => {\n       \n             rideinfo=snapshot;\n            });\n            // console.log('ELSE Fare Data',this.total_amount)\n            // console.log(' ELSE -----',rideinfo)\n            \n            this.userService.Insert_Ride(rideinfo,this.total_amount,10).then((result) => {\n  \n                  console.log(result);\n               \n                  \n               \n               }, (err) => {\n                 console.log(err);\n               });\n  \n            loading.dismiss();\n            this.viewCtrl.dismiss();\n            this.alertCtrl.create({ subTitle: 'Problem In Transaction', buttons: ['ok'] }).present();\n            this.singlenotification(1, 'Transaction Error', 'Your payment method was rejected');\n          } else {\n\n            for (let i = 0; i < length; i++) {\n              this.responsedata[response.childNodes[i].nodeName] = response.getElementsByTagName(response.childNodes[i].nodeName)[0].childNodes[0].nodeValue;\n              // console.log(response.getElementsByTagName(response.childNodes[i].nodeName)[0].childNodes[0].nodeValue);\n            }\n            let userId = JSON.parse(localStorage.getItem('userData'));\n\n            this.responsedata['UserId']=  userId.userId;\n           // console.log(\"Thsi Response data\", this.responsedata);\n\n            this.userService.tbtransaction(this.responsedata).then((result) => {\n\n              console.log(result['data']);\n              loading.dismiss();\n              this.viewCtrl.dismiss();\n              this.alertCtrl.create({ subTitle: ' Transaction Completed', buttons: ['ok'] }).present();\n              this.singlenotification(1, 'Transaction Completed', 'Payment has been made. Thanks');\n              //\n              \n              let rideinfo ;\n              this.tripService.getrideinfo(this.trip_key).subscribe(snapshot => {\n         \n               rideinfo=snapshot;\n              });\n              // console.log('Fare Data',this.total_amount)\n              // console.log('-----',rideinfo)\n              \n              this.userService.Insert_Ride(rideinfo,this.total_amount,4).then((result) => {\n                console.log(result);\n             \n                \n             \n             }, (err) => {\n               console.log(err);\n             });\n\n\n            }, (err) => {\n              loading.dismiss();\n              console.log(err);\n            });\n\n          }\n\n        }\n        else {\n\n          let rideinfo ;\n          this.tripService.getrideinfo(this.trip_key).subscribe(snapshot => {\n     \n           rideinfo=snapshot;\n          });\n\n          // console.log('ELSE Fare Data',this.total_amount)\n          // console.log(' ELSE -----',rideinfo)\n          \n          this.userService.Insert_Ride(rideinfo,this.total_amount,10).then((result) => {\n\n                console.log(result);\n             \n                \n             \n             }, (err) => {\n               console.log(err);\n             });\n\n       \n          this.alertCtrl.create({ subTitle: 'Transaction Is Not Done', buttons: ['ok'] }).present();\n          this.singlenotification(1, 'Transaction Error', 'Your payment method was rejected');\n          //this.mydata = null;\n          loading.dismiss();\n          this.viewCtrl.dismiss();\n        }\n\n\n\n\n      }\n    }\n    xmlhttp.setRequestHeader('Content-Type', 'text/xml');\n    xmlhttp.responseType = \"document\";\n    xmlhttp.send(sr);\n  }\n\n  // Push Notification\n  singlenotification(id, title, text) {\n    this.localNotifications.schedule({\n      id: id,\n      title: title,\n      text: text\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modal-final-fare/modal-final-fare.ts"],"sourceRoot":""}